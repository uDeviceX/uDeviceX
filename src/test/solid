#### Couette pinned sphere
# nTEST: solid.t1
rm -rf h5 bop diag.txt solid_diag.txt
(cd ../cmd; make ) > /dev/null
cp data/sdf/wall1/wall.dat sdf.dat
echo -e "16 16 16" > rigs-ic.txt
cp data/rig/sphere.ply mesh_solid.ply
:
u.conf conf/test.h <<!!!
   tend=2.01 part_freq=1000 walls wall_creation=1
   field_dumps part_dumps field_freq=1000
   solids sbounce_back pin_com dt=1e-3 WVEL_PAR_Z
   run
!!!
{ make clean && u.make -j ; } > /dev/null
sh runfile
u.avgh5 1 u 2 h5/flowfields-0001.h5 | sed -n '4,29p' | uscale 0.5 > h5.out.txt

#### Double poiseuille non pinned sphere
# nTEST: solid.t2
rm -rf h5 bop diag.txt solid_diag.txt
(cd ../cmd; make ) > /dev/null
echo -e "8 16 8" > rigs-ic.txt
cp data/rig/sphere.ply mesh_solid.ply
:
Force="bforce={type=\"double_poiseuille\"; a=6.666667;};"
u.conf conf/double.poiseuille.h <<!!!
   solids sbounce_back tend=0.5 part_freq=100
   field_dumps part_dumps
   wall_creation=0 field_freq=100
   run
!!!
{ make clean && u.make -j ; } > /dev/null
u.run ./udx $Force
cat solid_diag_0000.txt | awk '{print $2, $5, $8}' | uscale 5 > sdiag.out.txt

#### Couette pinned cylinder
# nTEST: solid.t3
rm -rf h5 bop diag.txt solid_diag.txt
(cd ../cmd; make ) > /dev/null
cp data/sdf/yplates1/yplates.dat sdf.dat
echo -e "16 16 8" > rigs-ic.txt
cp data/rig/cyl.ply mesh_solid.ply
:
u.conf conf/test.h <<!!!
   tend=2.01 part_freq=1000 walls wall_creation=100
   field_dumps part_dumps field_freq=1000 ZS=16
   solids spdir=2 sbounce_back dt=1e-3 WVEL_PAR_Y
   run
!!!
{ make clean && u.make -j ; } > /dev/null
u.run ./udx
u.avgh5 1 u 2 h5/flowfields-0001.h5 | sed -n '4,29p' | uscale 0.5 > h5.out.txt

#### two solids around cylinder with one solid removed by the wall
# nTEST: solid.t4
rm -rf h5 bop diag.txt solid_diag.txt
(cd ../cmd; make ) > /dev/null
cp data/sdf/cyl1/cyl.dat sdf.dat
cp data/rig/sphere_R1.ply mesh_solid.ply
x=0.75 y=3 z=9; echo $x $y $z >  rigs-ic.txt
x=8    y=8 z=8; echo $x $y $z >> rigs-ic.txt
:
Force="bforce={type=\"constant\"; f=[1.6666667,0.,0.];};"
u.conf conf/around.h <<!!!
    solids tend=1.0 part_freq=500 walls wall_creation=100 kBT=1e-7
    field_dumps part_dumps field_freq=500
    run
!!!
{ make clean && u.make -j ; } > /dev/null
u.run ./udx $Force
cat solid_diag_0000.txt | awk '{print $2, $5, $8}' | uscale 5 > sdiag.out.txt

#### two solids around cylinder with one solid removed by the wall on 2 ranks
# nTEST: solid.t5
rm -rf h5 bop diag.txt solid_diag.txt
cp data/sdf/cyl1/cyl.dat sdf.dat
cp data/rig/sphere_R1.ply mesh_solid.ply
x=0.75 y=3 z=9; echo $x $y $z >  rigs-ic.txt
x=8    y=8 z=8; echo $x $y $z >> rigs-ic.txt
:
Force="bforce={type=\"constant\"; f=[1.6666667,0.,0.];};"
u.conf conf/around.h <<!!!
   XS=8 solids tend=1.0 part_freq=500 walls wall_creation=100 kBT=1e-7
   field_dumps part_dumps field_freq=500 
   run
!!!
{ make clean && u.make -j ; } > /dev/null
u.run 2 1 1 ./udx $Force
cat solid_diag_0000.txt | awk '{print $2, $5, $8}' | uscale 5 > sdiag.out.txt
